
<div class="breadcrumbs">
    <a href="/administration-guide/installation">Installation</a>
    â†’ Docker
</div>

# Docker

&#x20;Create a `docker-compose.yml` file with following content:

```yaml
services:
  # uncomment this section and comment out the mysql section to use postgres instead of mysql
  #postgres:
    #restart: unless-stopped
    #image: postgres:14
    #hostname: postgres
    #volumes:
    #  - semaphore-postgres:/var/lib/postgresql/data
    #environment:
    #  POSTGRES_USER: semaphore
    #  POSTGRES_PASSWORD: semaphore
    #  POSTGRES_DB: semaphore
  # if you wish to use postgres, comment the mysql service section below
  mysql:
    restart: unless-stopped
    image: mysql:8.0
    hostname: mysql
    volumes:
      - semaphore-mysql:/var/lib/mysql
    environment:
      MYSQL_RANDOM_ROOT_PASSWORD: 'yes'
      MYSQL_DATABASE: semaphore
      MYSQL_USER: semaphore
      MYSQL_PASSWORD: semaphore
  semaphore:
    restart: unless-stopped
    ports:
      - 3000:3000
    image: semaphoreui/semaphore:latest
    environment:
      SEMAPHORE_DB_USER: semaphore
      SEMAPHORE_DB_PASS: semaphore
      SEMAPHORE_DB_HOST: mysql # for postgres, change to: postgres
      SEMAPHORE_DB_PORT: 3306 # change to 5432 for postgres
      SEMAPHORE_DB_DIALECT: mysql # for postgres, change to: postgres
      SEMAPHORE_DB: semaphore
      # To use SQLite instead of MySQL/Postgres (v2.16+)
      # SEMAPHORE_DB_DIALECT: sqlite
      # SEMAPHORE_DB: "/etc/semaphore/semaphore.sqlite"
      SEMAPHORE_PLAYBOOK_PATH: /tmp/semaphore/
      SEMAPHORE_ADMIN_PASSWORD: changeme
      SEMAPHORE_ADMIN_NAME: admin
      SEMAPHORE_ADMIN_EMAIL: admin@localhost
      SEMAPHORE_ADMIN: admin
      SEMAPHORE_ACCESS_KEY_ENCRYPTION: gs72mPntFATGJs9qK0pQ0rKtfidlexiMjYCH9gWKhTU=
      SEMAPHORE_LDAP_ACTIVATED: 'no' # if you wish to use ldap, set to: 'yes'
      SEMAPHORE_LDAP_HOST: dc01.local.example.com
      SEMAPHORE_LDAP_PORT: '636'
      SEMAPHORE_LDAP_NEEDTLS: 'yes'
      SEMAPHORE_LDAP_DN_BIND: 'uid=bind_user,cn=users,cn=accounts,dc=local,dc=shiftsystems,dc=net'
      SEMAPHORE_LDAP_PASSWORD: 'ldap_bind_account_password'
      SEMAPHORE_LDAP_DN_SEARCH: 'dc=local,dc=example,dc=com'
      SEMAPHORE_LDAP_SEARCH_FILTER: "(\u0026(uid=%s)(memberOf=cn=ipausers,cn=groups,cn=accounts,dc=local,dc=example,dc=com))"
      TZ: UTC
    depends_on:
      - mysql # for postgres, change to: postgres
volumes:
  semaphore-mysql: # to use postgres, switch to: semaphore-postgres
```

You must specify following confidential variables:

* `MYSQL_PASSWORD` and `SEMAPHORE_DB_PASS` &mdash; password for the MySQL user.
* `SEMAPHORE_ADMIN_PASSWORD` &mdash; password for the Semaphore's admin user.
* `SEMAPHORE_ACCESS_KEY_ENCRYPTION` &mdash; key for encrypting access keys in database. It must be generated by using the following command: `head -c32 /dev/urandom | base64`.

If you are using Docker Swarm, it is strongly recommended that you don't embed credentials directly in the Compose file (nor in environment variables generally) and instead use [Docker Secrets](https://docs.docker.com/engine/swarm/secrets/). Semaphore [supports](https://github.com/semaphoreui/semaphore/issues/1268) a common Docker container pattern for retrieving settings from files instead of the environment by appending `_FILE` to the end of the environment variable name. See the [Docker documentation for an example](https://docs.docker.com/engine/swarm/secrets/#use-secrets-in-compose).

A limited example using secrets:

```yaml
secrets:
  semaphore_admin_pw:
    file: semaphore_admin_password.txt

services:
  semaphore:
    restart: unless-stopped
    ports:
      - 3000:3000
    image: semaphoreui/semaphore:latest
    environment:
      SEMAPHORE_ADMIN_PASSWORD_FILE: /run/secrets/semaphore_admin_pw
      SEMAPHORE_ADMIN_NAME: admin
      SEMAPHORE_ADMIN_EMAIL: admin@localhost
      SEMAPHORE_ADMIN: admin
```


Run the following command to start Semaphore with configured database (MySQL or Postgres):

```bash
docker-compose up
```

&#x20;Semaphore will be available via the following URL [http://localhost:3000](http://localhost:3000).

## Installing Additional Python Dependencies

When the Semaphore container starts, it can automatically install additional Python packages that you may need for your Ansible playbooks. To use this feature:

1. Create a `requirements.txt` file with your Python dependencies
2. Mount this file to the container at the path specified by `SEMAPHORE_CONFIG_PATH` (defaults to `/etc/semaphore`)

Example update to your `docker-compose.yml`:

```yaml
services:
  semaphore:
    restart: unless-stopped
    ports:
      - 3000:3000
    image: semaphoreui/semaphore:latest
    volumes:
      - ./requirements.txt:/etc/semaphore/requirements.txt
```

During container startup, Semaphore will detect the `requirements.txt` file and automatically run `pip3 install --upgrade -r ${SEMAPHORE_CONFIG_PATH}/requirements.txt` to install the specified packages.
